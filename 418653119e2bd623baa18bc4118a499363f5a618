{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "33a75fad_b6a86ea8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2023-04-28T03:40:53Z",
      "side": 1,
      "message": "This looks better. I found one further issue regarding consistency of `open()` flags.",
      "revId": "418653119e2bd623baa18bc4118a499363f5a618",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "02ead890_a8f1f062",
        "filename": "log-handler.c",
        "patchSetId": 9
      },
      "lineNbr": 65,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2023-04-28T03:40:53Z",
      "side": 1,
      "message": "The open flags need to be the same here as below. Perhaps use a macro or add a flags member to `struct log_handler` so we can\u0027t make them inconsistent.",
      "revId": "418653119e2bd623baa18bc4118a499363f5a618",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e133c979_821ad2a5",
        "filename": "log-handler.c",
        "patchSetId": 9
      },
      "lineNbr": 65,
      "author": {
        "id": 1000305
      },
      "writtenOn": "2023-04-28T04:43:05Z",
      "side": 1,
      "message": "Maybe\n\nopen(lh-\u003elog_filename, O_WRONLY | O_CREAT | O_TRUNC, 0644); ？truncate log file（creat a new file） and set the lh-\u003esize \u003d 0. \n\nO_APPEND and set lh-\u003esize \u003d 0, looks a bit weird",
      "parentUuid": "02ead890_a8f1f062",
      "revId": "418653119e2bd623baa18bc4118a499363f5a618",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7329863a_62913e9b",
        "filename": "log-handler.c",
        "patchSetId": 9
      },
      "lineNbr": 65,
      "author": {
        "id": 1000305
      },
      "writtenOn": "2023-04-28T06:22:44Z",
      "side": 1,
      "message": "or Maybe I don\u0027t understand your comment :(",
      "parentUuid": "e133c979_821ad2a5",
      "revId": "418653119e2bd623baa18bc4118a499363f5a618",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2bd83716_ad161fbd",
        "filename": "log-handler.c",
        "patchSetId": 9
      },
      "lineNbr": 65,
      "author": {
        "id": 1000733
      },
      "writtenOn": "2023-05-03T01:45:50Z",
      "side": 1,
      "message": "I think what Andrew meant was just that we should ensure we always use the same set of flags when we open the log file.  Because there are two places that call `open()` to do that, we need to make sure that both places pass the same flags.  One option for a clean way of achieving that would be to do something like:\n\n```\n#define LOGFILE_O_FLAGS (O_WRONLY | O_CREAT | O_TRUNC)\n```\n\nand then just pass `LOGFILE_O_FLAGS` to `open()` in both places.",
      "parentUuid": "7329863a_62913e9b",
      "revId": "418653119e2bd623baa18bc4118a499363f5a618",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}