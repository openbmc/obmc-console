{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "e541ef06_6fbde350",
        "filename": "log-handler.c",
        "patchSetId": 2
      },
      "lineNbr": 144,
      "author": {
        "id": 1000733
      },
      "writtenOn": "2023-04-19T15:56:43Z",
      "side": 1,
      "message": "Perhaps I\u0027m missing something, but would `open(O_RWDR | O_CREAT | O_APPEND)` be a simpler way to achieve pretty much the same thing?",
      "range": {
        "startLine": 129,
        "startChar": 16,
        "endLine": 144,
        "endChar": 2
      },
      "revId": "d9511ae7bdc64f58bb579cfe33f68fb785e9495b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3cdd37ba_4e1377c3",
        "filename": "log-handler.c",
        "patchSetId": 2
      },
      "lineNbr": 144,
      "author": {
        "id": 1000305
      },
      "writtenOn": "2023-04-23T02:14:35Z",
      "side": 1,
      "message": "log_create is used to get the fd/size of the log file\n\nIt uses stat function to check if log file exists, and if doesn\u0027t, create a new one.\n\nif it does, open the file with O_APPEND flag",
      "parentUuid": "e541ef06_6fbde350",
      "range": {
        "startLine": 129,
        "startChar": 16,
        "endLine": 144,
        "endChar": 2
      },
      "revId": "d9511ae7bdc64f58bb579cfe33f68fb785e9495b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d091f79e_f929f236",
        "filename": "log-handler.c",
        "patchSetId": 2
      },
      "lineNbr": 144,
      "author": {
        "id": 1000733
      },
      "writtenOn": "2023-04-27T19:39:14Z",
      "side": 1,
      "message": "But what does that manual sequence achieve that a single `open(O_RDWR | O_CREAT | O_APPEND)` wouldn\u0027t?\n\nAnd actually on a separate note, I see the `O_RDWR` is in the existing code and not introduced in this patch, but it\u0027s not clear to me why we even need `O_RDWR` instead of `O_WRONLY`...",
      "parentUuid": "3cdd37ba_4e1377c3",
      "range": {
        "startLine": 129,
        "startChar": 16,
        "endLine": 144,
        "endChar": 2
      },
      "revId": "d9511ae7bdc64f58bb579cfe33f68fb785e9495b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c1d5d95b_59183505",
        "filename": "log-handler.c",
        "patchSetId": 2
      },
      "lineNbr": 144,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2023-04-28T02:48:13Z",
      "side": 1,
      "message": "Prior to `93fd8a39d8d2 (\"log_trim: Rotate log instead of truncate\")` the algorithm for maintaining the log `mmap()`ed the log file storage to implement a ring-buffer. The referenced patch changed that to the rename approach we now use, which is closer to logrotate. `O_RDWR` is a hangover from the `mmap()` days.\n\nI agree with @zev the implementation should now use `open(..., O_WRONLY | O_CREAT | O_APPEND)` and save on the complexity proposed here.",
      "parentUuid": "d091f79e_f929f236",
      "range": {
        "startLine": 129,
        "startChar": 16,
        "endLine": 144,
        "endChar": 2
      },
      "revId": "d9511ae7bdc64f58bb579cfe33f68fb785e9495b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d5cf0c29_53dfdfca",
        "filename": "log-handler.c",
        "patchSetId": 2
      },
      "lineNbr": 144,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2023-04-28T03:40:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c1d5d95b_59183505",
      "range": {
        "startLine": 129,
        "startChar": 16,
        "endLine": 144,
        "endChar": 2
      },
      "revId": "d9511ae7bdc64f58bb579cfe33f68fb785e9495b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}